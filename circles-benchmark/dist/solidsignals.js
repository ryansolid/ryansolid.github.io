!function(){"use strict";function n(n,e){const l=new t(n);let o;if(e){let t=-1;o=o=>{if(!e(n,o)){const e=a.time;if(e===t)throw new Error(`Conflicting value update: ${o} is not the same as ${n}`);t=e,n=o,l.next(o)}}}else o=l.next.bind(l);return[l.current.bind(l),o]}function e(n,e){!function(n,e,t,l){var o=g(),s=h,u=f,r=null===d;h=o,f=l?null:o,e=r?function(n,e){d=a,a.changes.reset(),a.updates.reset();try{return n(e)}finally{h=f=d=null}}(n,e):n(e);h=s,f=u,v(o,n,e,t),r&&function(n,e){if(a.changes.count>0||a.updates.count>0){a.time++;try{m(a)}finally{d=null,h=n,f=e}}}(s,u)}(n,e,!1,!1)}class t{constructor(n){this.value=n,this.pending=s,this.log=null}current(){return null!==f&&function(n){null===n.log&&(n.log={node1:null,node1slot:0,nodes:null,nodeslots:null});!function(n){var e,t=f,l=null===t.source1?-1:null===t.sources?0:t.sources.length;null===n.node1?(n.node1=t,n.node1slot=l,e=-1):null===n.nodes?(n.nodes=[t],n.nodeslots=[l],e=0):(e=n.nodes.length,n.nodes.push(t),n.nodeslots.push(l));null===t.source1?(t.source1=n,t.source1slot=e):null===t.sources?(t.sources=[n],t.sourceslots=[e]):(t.sources.push(n),t.sourceslots.push(e))}(n.log)}(this),this.value}next(n){if(null!==d)if(this.pending!==s){if(n!==this.pending)throw new Error("conflicting changes: "+n+" !== "+this.pending)}else this.pending=n,a.changes.add(this);else null!==this.log?(this.pending=n,a.changes.add(this),w()):this.value=n;return n}}class l{constructor(){this.fn=null,this.age=-1,this.state=u,this.source1=null,this.source1slot=0,this.sources=null,this.sourceslots=null,this.owner=h,this.owned=null,this.cleanups=null}}class o{constructor(){this.items=[],this.count=0}reset(){this.count=0}add(n){this.items[this.count++]=n}run(n){for(var e=this.items,t=0;t<this.count;t++)n(e[t]),e[t]=null;this.count=0}}var s={},u=0,r=1,i=2,c=new l,a={time:0,changes:new o,updates:new o,disposes:new o},d=null,f=null,h=null,p=null;function g(){var n=p;return null===n?n=new l:p=null,n}function v(n,e,t,l){var o,s=l||null===h||h===c?null:h,u=!n.noRecycle&&null===n.source1&&(null===n.owned&&null===n.cleanups||null!==s);if(u){if(p=n,n.owner=null,null!==s){if(null!==n.owned){if(null===s.owned)s.owned=n.owned;else for(o=0;o<n.owned.length;o++)s.owned.push(n.owned[o]);n.owned=null}if(null!==n.cleanups){if(null===s.cleanups)s.cleanups=n.cleanups;else for(o=0;o<n.cleanups.length;o++)s.cleanups.push(n.cleanups[o]);n.cleanups=null}}}else n.fn=e,n.value=t,n.age=a.time,null!==s&&(null===s.owned?s.owned=[n]:s.owned.push(n));return u}function w(){var n=h;a.updates.reset(),a.time++;try{m(a)}finally{d=f=null,h=n}}function m(n){var e=d,t=0;for(d=n,n.disposes.reset();0!==n.changes.count||0!==n.updates.count||0!==n.disposes.count;)if(t>0&&n.time++,n.changes.run(y),n.updates.run(b),n.disposes.run(N),t++>1e5)throw new Error("Runaway clock detected");d=e}function y(n){n.value=n.pending,n.pending=s,n.log&&function(n){var e=n.node1,t=n.nodes;null!==e&&C(e);if(null!==t)for(var l=0,o=t.length;l<o;l++)C(t[l])}(n.log)}function C(n){var e=a.time;n.age<e&&(n.age=e,n.state=r,a.updates.add(n),null!==n.owned&&function n(e){for(var t=0;t<e.length;t++){var l=e[t];l.age=a.time,l.state=u,null!==l.owned&&n(l.owned)}}(n.owned))}function b(n){if(n.state===r){var e=h,t=f;h=f=n,n.state=i,x(n,!1),n.value=n.fn(n.value),n.state=u,h=e,f=t}}function x(n,e){var t,l,o=n.source1,s=n.sources,u=n.sourceslots,r=n.cleanups,i=n.owned;if(null!==r){for(t=0;t<r.length;t++)r[t](e);n.cleanups=null}if(null!==i){for(t=0;t<i.length;t++)N(i[t]);n.owned=null}if(null!==o&&(S(o,n.source1slot),n.source1=null),null!==s)for(t=0,l=s.length;t<l;t++)S(s.pop(),u.pop())}function S(n,e){var t,l,o=n.nodes,s=n.nodeslots;-1===e?n.node1=null:(t=o.pop(),l=s.pop(),e!==o.length&&(o[e]=t,s[e]=l,-1===l?t.source1slot=e:t.sourceslots[l]=e))}function N(n){n.fn=null,n.owner=null,x(n,!0)}const T="__rGroup",A="previousSibling";let B=0;function k(n,t,l,o,s){if(Array.isArray(t)){if(!t.length)return;let e=(t=function n(e,t){for(let l=0,o=t.length;l<o;l++){let o=t[l];o instanceof Node?11===o.nodeType?n(e,o.childNodes):e.push(o):null==o||!0===o||!1===o||(Array.isArray(o)?n(e,o):"string"==typeof o?e.push(document.createTextNode(o)):e.push(document.createTextNode(o.toString())))}return e}([],t))[0];1!==t.length&&(e[T]=t[t.length-1][T]=o);for(let e=0;e<t.length;e++)l?n.insertBefore(t[e],l):n.appendChild(t[e]);return e}let u,r=typeof t;if(null==t||"string"===r||"number"===r)t=document.createTextNode(t||"");else{if("function"===r)return e(()=>{const e=t();if(e){let t=l;u&&(t=u.nextSibling,n.removeChild(u)),u=k(n,e,t,o,s)}}),u||(u=document.createTextNode(""),l?n.insertBefore(u,l):n.appendChild(u)),u;11===t.nodeType&&(u=t.firstChild)&&u!==t.lastChild&&(u[T]=t.lastChild[T]=o)}return l?n.insertBefore(t,l):n.appendChild(t),s&&s(u||t),u||t}function E(n,e,t,l){return void 0===t?n.textContent="":(Array.isArray(e)?l=e[0]:null!=e&&""!=e&&null==l&&(l=function(n,e,t){const l=n[T];if(l)for(n=n[e];n&&n[T]!==l;)n=n[e];return t?n:n[e]}(t&&t.previousSibling||n.lastChild,A,!0)),l&&function(n,e,t){let l;for(;e!==t;)l=e.nextSibling,n.removeChild(e),e=l}(n,l,t),"")}function $(n,e,t,l,o){if(e===t)return t;n=l&&l.parentNode||o&&o.parentNode||n;const s=typeof e;if("string"===s||"number"===s)if("number"===s&&(e=e.toString()),void 0!==l){const s=l&&l.previousSibling||o&&o.nextSibling||n.lastChild;if(""===e)E(n,t,l);else if(""!==t&&"string"==typeof t)s.data=e;else{const o=document.createTextNode(e);""!==t&&null!=t?n.replaceChild(o,s):n.insertBefore(o,l)}t=e}else t=""!==t&&"string"==typeof t?n.firstChild.data=e:n.textContent=e;else if(null==e||"boolean"===s)t=E(n,t,l);else{if(!(e instanceof Node||Array.isArray(e)))throw new Error("content must be Node, stringable, or array of same");""!==t&&null!=t&&E(n,t,l),k(n,e,l,++B),t=e}return t}function F(n,t,l,o){if("function"!=typeof t)return $(n,t,o,l);let s;void 0!==l&&(s=l?l.previousSibling:n.lastChild),e((e=o)=>$(n,t(),e,l,s))}const L=function(n){const e=document.createElement("template");return e.innerHTML=n,e}("<div class='box-view'><div class='box'></div></div>");function M(n){const e=++n.count;n.setTop(10*Math.sin(e/10)),n.setLeft(10*Math.cos(e/10)),n.setColor(e%255),n.setContent(e%100)}const R=()=>{const t=function(e){const t=[];for(let l=0;l<e;l++){const[e,l]=n(0),[o,s]=n(0),[u,r]=n(null),[i,c]=n(0);t.push({top:e,left:o,color:u,content:i,setTop:l,setLeft:s,setColor:r,setContent:c,count:0})}return t}(Benchmark.number);return Benchmark.Framework.SolidSignals.loop=()=>Promise.resolve().then(()=>(function(n){var e=void 0;if(null!==d)e=n();else{(d=a).changes.reset();try{e=n(),w()}finally{d=null}}return e})(()=>t.forEach(M))),function(){const n=document.createDocumentFragment();return F(n,t.map((n,t)=>(function(){const l=L.content.firstChild.cloneNode(!0),o=l.firstChild;return o.id=t,e(()=>Object.assign(o.style,{top:`${n.top()}px`,left:`${n.left()}px`,background:`rgb(0,0,${n.color()})`})),F(o,n.content),l})())),n}()};let _;Benchmark.Framework.SolidSignals={start(){!function(n,e){var t,l=h,o=0===n.length?null:function(){null===s||(null!==d?a.disposes.add(s):N(s))},s=null===o?c:g();let u=e||h;s!==u&&(s.owner=u),h=s;try{t=null===o?n():n(o)}finally{h=l}null!==o&&v(s,null,void 0,!0)&&(s=null)}(n=>{_=n,document.getElementById("grid").appendChild(R())})},cleanup(){_&&_()}}}();
