!function(){"use strict";var e=function(e,n){var t=new l(e,n);return function(){return t.current()}};Object.defineProperty(e,"default",{value:e}),e.root=function(e){var n=p,t=0===e.length?g:new l(null,null),o=void 0,r=0===e.length?null:function(){null!==d?f.disposes.add(t):N(t)};return p=t,null===d?o=function(e,n,t){try{return null===n?e():e(n)}finally{p=t}}(e,r,n):(o=null===r?e():e(r),p=n),o},e.on=function(n,t,o,l){var r;return Array.isArray(n)&&(r=n,n=function(){for(var e=0;e<r.length;e++)r[e]()}),l=!!l,e(i,o);function i(e){var o=h;return n(),l?l=!1:(h=null,e=t(e),h=o),e}},e.effect=function(e,n){new l(e,n)},e.data=function(e){var n=new o(e);return function(e){return 0===arguments.length?n.current():n.next(e)}},e.value=function(n,t){var o=e.data(n),l=-1;return function(e){if(0===arguments.length)return o();if(!(t?t(n,e):n===e)){var r=f.time;if(l===r)throw new Error("conflicting values: "+e+" is not the same as "+n);l=r,n=e,o(e)}return e}},e.freeze=function(e){var n=void 0;if(null!==d)n=e();else{(d=f).changes.reset();try{n=e(),y()}finally{d=null}}return n},e.sample=function(e){var n,t=h;return null!==t?(h=null,n=e(),h=t):n=e(),n},e.cleanup=function(e){null!==p?null===p.cleanups?p.cleanups=[e]:p.cleanups.push(e):console.warn("cleanups created without a root or parent will never be run")},e.makeDataNode=function(e){return new o(e)},e.makeComputationNode=function(e,n){return new l(e,n)},e.isFrozen=function(){return null!==d},e.isListening=function(){return null!==h};var n=function(){return function(){this.time=0,this.changes=new i,this.updates=new i,this.disposes=new i}}(),t={time:function(){return f.time}},o=function(){function e(e){this.value=e,this.pending=s,this.log=null}return e.prototype.current=function(){return null!==h&&function(e,n){null===e.log&&(e.log=new r);v(e.log,n)}(this,h),this.value},e.prototype.next=function(e){if(null!==d)if(this.pending!==s){if(e!==this.pending)throw new Error("conflicting changes: "+e+" !== "+this.pending)}else this.pending=e,f.changes.add(this);else null!==this.log?(this.pending=e,f.changes.add(this),y()):this.value=e;return e},e.prototype.clock=function(){return t},e}(),l=function(){function e(e,n){if(this.state=u,this.source1=null,this.source1slot=0,this.sources=null,this.sourceslots=null,this.log=null,this.owned=null,this.cleanups=null,this.fn=e,this.value=n,this.age=f.time,null!==e){var t=p,o=h;null===t&&console.warn("computations created without a root or parent will never be disposed"),p=h=this,null===d?function(e){d=f,f.changes.reset(),f.updates.reset();try{e.value=e.fn(e.value),(f.changes.count>0||f.updates.count>0)&&(f.time++,m(f))}finally{d=p=h=null}}(this):this.value=this.fn(this.value),t&&t!==g&&(null===t.owned?t.owned=[this]:t.owned.push(this)),p=t,h=o}}return e.prototype.current=function(){if(null!==h){if(this.age===f.time){if(this.state===c)throw new Error("circular dependency");S(this)}!function(e,n){null===e.log&&(e.log=new r);v(e.log,n)}(this,h)}return this.value},e.prototype.clock=function(){return t},e}(),r=function(){return function(){this.node1=null,this.node1slot=0,this.nodes=null,this.nodeslots=null}}(),i=function(){function e(){this.items=[],this.count=0}return e.prototype.reset=function(){this.count=0},e.prototype.add=function(e){this.items[this.count++]=e},e.prototype.run=function(e){for(var n=this.items,t=0;t<this.count;t++)e(n[t]),n[t]=null;this.count=0},e}(),s={},u=0,a=1,c=2,f=new n,d=null,h=null,p=null,g=new l(null,null);function v(e,n){var t,o=null===n.source1?-1:null===n.sources?0:n.sources.length;null===e.node1?(e.node1=n,e.node1slot=o,t=-1):null===e.nodes?(e.nodes=[n],e.nodeslots=[o],t=0):(t=e.nodes.length,e.nodes.push(n),e.nodeslots.push(o)),null===n.source1?(n.source1=e,n.source1slot=t):null===n.sources?(n.sources=[e],n.sourceslots=[t]):(n.sources.push(e),n.sourceslots.push(t))}function y(){var e=p;f.updates.reset(),f.time++;try{m(f)}finally{d=h=null,p=e}}function m(e){var n=d,t=0;for(d=e,e.disposes.reset();0!==e.changes.count||0!==e.updates.count||0!==e.disposes.count;)if(t>0&&e.time++,e.changes.run(w),e.updates.run(S),e.disposes.run(N),t++>1e5)throw new Error("Runaway clock detected");d=n}function w(e){e.value=e.pending,e.pending=s,e.log&&b(e.log)}function b(e){var n=e.node1,t=e.nodes;if(null!==n&&C(n),null!==t)for(var o=0,l=t.length;o<l;o++)C(t[o])}function C(e){var n=f.time;e.age<n&&(e.age=n,e.state=a,f.updates.add(e),null!==e.owned&&function e(n){for(var t=0;t<n.length;t++){var o=n[t];o.age=f.time,o.state=u,null!==o.owned&&e(o.owned)}}(e.owned),null!==e.log&&b(e.log))}function S(e){if(e.state===a){var n=p,t=h;p=h=e,e.state=c,x(e,!1),e.value=e.fn(e.value),e.state=u,p=n,h=t}}function x(e,n){var t,o,l=e.source1,r=e.sources,i=e.sourceslots,s=e.cleanups,u=e.owned;if(null!==s){for(t=0;t<s.length;t++)s[t](n);e.cleanups=null}if(null!==u){for(t=0;t<u.length;t++)N(u[t]);e.owned=null}if(null!==l&&(k(l,e.source1slot),e.source1=null),null!==r)for(t=0,o=r.length;t<o;t++)k(r.pop(),i.pop())}function k(e,n){var t,o,l=e.nodes,r=e.nodeslots;-1===n?e.node1=null:(t=l.pop(),o=r.pop(),n!==l.length&&(l[n]=t,r[n]=o,-1===o?t.source1slot=n:t.sourceslots[o]=n))}function N(e){e.fn=null,e.log=null,x(e,!0)}function A(n,t){const o=e.makeDataNode(n);let l;if(t){let e=-1;l=(l=>{if(!t(n,l)){const t=o.clock().time();if(t===e)throw new Error(`Conflicting value update: ${l} is not the same as ${n}`);e=t,n=l,o.next(l)}})}else l=o.next.bind(o);return[o.current.bind(o),l]}const{root:E,cleanup:B,sample:L,freeze:T}=e,F="__rGroup",M="__rid",_="nextSibling",z="previousSibling";let $=0;function j(e,n){const t=e[F];if(e=e[n],t){for(;e&&e[F]!==t;)e=e[n];e=e[n]}return e}function O(e,n,t){let o;for(;n!==t;)o=n.nextSibling,e.removeChild(n),n=o}function P(e,n,t,o){let l;for(;n!==t;)l=n.nextSibling,e.insertBefore(n,o),n=l}function D(e,n){const t=n[M];e.get(t)(),e.delete(t)}function H(e,n,t,o,l,r,i){const{wrap:s,cleanup:u,root:a,sample:c}=l;let f=new Map;function d(n,o,l){return a(r=>(f.set(++$,r),function(e,n,t){if(Array.isArray(e)){if(!e.length)return;let o=e[0];o[M]=$,1!==e.length&&(o[F]=$,e[e.length-1][F]=$,e[e.length-1][M]=$);for(let o=0;o<e.length;o++)t?n.insertBefore(e[o],t):n.appendChild(e[o]);return o}let o;return 11===e.nodeType?(e.__mounted={parent:n,marker:t},(o=e.firstChild)&&(o[M]=$,o!==e.lastChild&&(o[F]=$,e.lastChild[F]=$,e.lastChild[M]=$))):e[M]=$,t?n.insertBefore(e,t):n.appendChild(e),o||e}(t(n,o),e,l)))}function h(){o&&o(r?r.nextSibling:e.firstChild,i)}u(function(){for(let e of f.keys())f.get(e)();f.clear()}),s((t=[])=>{const o=n();return c(()=>{e=i&&i.parentNode||e;const n=o.length;if(0===n){if(void 0!==r||void 0!==i){let n=null!=r?r.nextSibling:e.firstChild;O(e,n,void 0===i?null:i)}else e.textContent="";for(let e of f.keys())f.get(e)();return f.clear(),h(),[]}if(0===t.length){let e=new Array(n);for(let t=0;t<n;t++)d(e[t]=o[t],t,i);return h(),e}let l,s,u=0,a=0,c=!0,p=t.length-1,g=n-1,v=r?r.nextSibling:e.firstChild,y=v,m=i?i.previousSibling:e.lastChild,w=i;e:for(;c;){let n;for(c=!1,l=t[u],s=o[a];l===s;){if(u++,a++,y=v=j(v,_),p<u||g<a)break e;l=t[u],s=o[a]}for(l=t[p],s=o[g];l===s;){if(p--,g--,w=m,m=j(m,z),p<u||g<a)break e;l=t[p],s=o[g]}for(l=t[p],s=o[a];l===s;){c=!0;let r=(n=j(m,z)).nextSibling;if(y!==r&&(P(e,r,m.nextSibling,y),m=n),a++,--p<u||g<a)break e;l=t[p],s=o[a]}for(l=t[u],s=o[g];l===s;){if(c=!0,n=j(v,_),v!==w){let t=n.previousSibling;P(e,v,n,w),w=t,v=n}if(g--,p<++u||g<a)break e;l=t[u],s=o[g]}}if(g<a){if(u<=p){let n,t,o;for(;u<=p;){if(t=(o=m)[F])for(o=o.previousSibling;o&&o[F]!==t;)o=o.previousSibling;n=o.previousSibling,O(e,o,m.nextSibling),D(f,m),m=n,p--}}return h(),o.slice(0)}if(p<u){if(a<=g)for(;a<=g;)d(o[a],a,w),a++;return h(),o.slice(0)}const b=new Array(g+1-a);for(let e=a;e<=g;e++)b[e]=-1;const C=new Map;for(let e=a;e<=g;e++)C.set(o[e],e);let S=0,x=[];for(let e=u;e<=p;e++)C.has(t[e])?(b[C.get(t[e])]=e,S++):x.push(e);if(0===S){const n=v!==e.firstChild||m!==e.lastChild;let t,l=v;for(w=m.nextSibling;l!==w;)t=j(l,_),D(f,l),n&&O(e,l,t),l=t,u++;!n&&(e.textContent="");for(let e=a;e<=g;e++)d(o[e],e,w);return h(),o.slice(0)}const k=function(e,n){for(var t=[],o=[],l=-1,r=new Array(e.length),i=n,s=e.length;i<s;i++){var u=e[i];if(!(u<0)){var a=G(t,u);-1!==a&&(r[i]=o[a]),a===l?(t[++l]=u,o[l]=i):u<t[a+1]&&(t[a+1]=u,o[a+1]=i)}}for(i=o[l];l>=0;i=r[i],l--)t[l]=i;return t}(b,a),N=[];let A,E=v,B=k.length-1;for(let e=u;e<=p;e++)N[e]=E,E=j(E,_);for(let n=0;n<x.length;n++){let t=N[x[n]];O(e,t,j(t,_)),D(f,t)}for(let n=g;n>=a;n--)k[B]===n?(w=N[b[k[B]]],B--):(-1===b[n]?A=d(o[n],n,w):(A=N[b[n]],P(e,A,j(A,_),w)),w=A);return h(),o.slice(0)})})}function G(e,n){var t=-1,o=e.length;if(o>0&&e[o-1]<=n)return o-1;for(;o-t>1;){var l=Math.floor((t+o)/2);e[l]>n?o=l:t=l}return t}const I="property";var R={href:{type:"attribute"},style:{type:I,alias:"style.cssText"},for:{type:I,alias:"htmlFor"},class:{type:I,alias:"className"},spellCheck:{type:I,alias:"spellcheck"},allowFullScreen:{type:I,alias:"allowFullscreen"},autoCapitalize:{type:I,alias:"autocapitalize"},autoFocus:{type:I,alias:"autofocus"},autoPlay:{type:I,alias:"autoplay"}};function q(e,n,t,o){if(!t)return e.textContent="";if(Array.isArray(n))for(let t=0;t<n.length;t++)e.removeChild(n[t]);else if(null!=n&&""!=n)if(void 0!==o){let n,l=t.previousSibling;for(;l!==o;)n=l.previousSibling,e.removeChild(l),l=n}else e.removeChild(t.previousSibling);return""}const J=function(e){const{wrap:n,cleanup:t,root:o}=e;function l(e,t,o,r){if(t===o)return o;e=r&&r.parentNode||e;const i=typeof t;if("string"===i||"number"===i)if("number"===i&&(t=t.toString()),r){if(""===t)q(e,o,r);else if(""!==o&&"string"==typeof o)r.previousSibling.data=t;else{const n=document.createTextNode(t);""!==o&&null!=o?e.replaceChild(n,r.previousSibling):e.insertBefore(n,r)}o=t}else o=""!==o&&"string"==typeof o?e.firstChild.data=t:e.textContent=t;else if(null==t||"boolean"===i)o=q(e,o,r);else if("function"===i)n(function(){o=l(e,t(),o,r)});else if(t instanceof Node)Array.isArray(o)?0===o.length?e.insertBefore(t,r):1===o.length?e.replaceChild(t,o[0]):(q(e,o,r),e.appendChild(t)):null==o||""===o?e.insertBefore(t,r):e.replaceChild(t,r&&r.previousSibling||e.firstChild),o=t;else{if(!Array.isArray(t))throw new Error("content must be Node, stringable, or array of same");{let n=function e(n,t){for(var o=0,l=t.length;o<l;o++){var r=t[o];r instanceof Node?11===r.nodeType?e(n,r.childNodes):n.push(r):null==r||!0===r||!1===r||(Array.isArray(r)?e(n,r):"string"==typeof r?n.push(r):n.push(r.toString()))}return n}([],t);if(q(e,o,r),0!==n.length)for(let t=0,o=n.length;t<o;t++){let o=n[t];o instanceof Node||(o=n[t]=document.createTextNode(o)),e.insertBefore(o,r)}o=n}}return o}return Object.assign({insert(e,t,o,r){if("function"!=typeof t)return l(e,t,o,r);n((n=o)=>l(e,t(),n,r))},addEventListener(e,n,t){e.addEventListener(n,e=>{if(t.length<2)return t(e);const n=function e(n){let t,o=n.model,l=n.action;return void 0===o&&n.parentNode&&(t=e(n.parentNode)),[void 0!==o?o:t&&t[0],l||t&&t[1]]}(e.target);t(e,n[0],n[1])})},spread(e,t){n(function(){const n=t();let o;for(const t in n){const l=n[t];if("style"===t)Object.assign(e.style,l);else if("classList"===t)for(const n in l)e.classList.toggle(n,l[n]);else(o=R[t])?"attribute"===o.type?e.setAttribute(t,l):e[o.alias]=l:e[t]=l}})},flow(r,i,s,u,a,c){let f;if(c&&(f=c.previousSibling),"each"===i)H(r,s,u,a,e,f,c);else if("when"===i){let e,i;t(function(){i&&i()}),n(n=>{const t=s();return t===n?n:(i&&i(),r=c&&c.parentNode||r,null==t||!1===t?(q(r,e,c,f),e=null,t):(o(n=>{i=n,e=l(r,u(t),e,c),a&&a(e,c)}),t))})}}},e)}({wrap:e.makeComputationNode,root:e.root,cleanup:e.cleanup,sample:e.sample}),K=document.createElement("template");K.innerHTML="<div class='box-view'><div class='box'></div></div>";const Q=document.createElement("template");function U(e){const n=++e.count;e.setTop(10*Math.sin(n/10)),e.setLeft(10*Math.cos(n/10)),e.setColor(n%255),e.setContent(n%100)}Q.innerHTML="";const V=()=>{const e=function(e){const n=[];for(let t=0;t<e;t++){const[e,t]=A(0),[o,l]=A(0),[r,i]=A(null),[s,u]=A(0);n.push({top:e,left:o,color:r,content:s,setTop:t,setLeft:l,setColor:i,setContent:u,count:0})}return n}(Benchmark.number);return Benchmark.Framework.SolidSignals.loop=(()=>Promise.resolve().then(()=>T(()=>e.forEach(U)))),function(){const n=Q.content.cloneNode(!0);return J.insert(n,e.map((e,n)=>(function(){const t=K.content.firstChild.cloneNode(!0),o=t.firstChild;return o.id=n,J.wrap(()=>Object.assign(o.style,{top:`${e.top()}px`,left:`${e.left()}px`,background:`rgb(0,0,${e.color()})`})),J.insert(o,e.content),t})())),n}()};let W;Benchmark.Framework.SolidSignals={start(){E(e=>{W=e,document.getElementById("grid").appendChild(V())})},cleanup(){W&&W()}}}();
